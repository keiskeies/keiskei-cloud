(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-cloud-image-index"],{"13a1":function(t,e,a){"use strict";a("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={name:"u-image",props:{src:{type:String,default:""},mode:{type:String,default:"aspectFill"},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"auto"},shape:{type:String,default:"square"},borderRadius:{type:[String,Number],default:0},lazyLoad:{type:Boolean,default:!0},showMenuByLongpress:{type:Boolean,default:!0},loadingIcon:{type:String,default:"photo"},errorIcon:{type:String,default:"error-circle"},showLoading:{type:Boolean,default:!0},showError:{type:Boolean,default:!0},fade:{type:Boolean,default:!0},webp:{type:Boolean,default:!1},duration:{type:[String,Number],default:500},bgColor:{type:String,default:"#f3f4f6"}},data:function(){return{isError:!1,loading:!0,opacity:1,durationTime:this.duration,backgroundStyle:{}}},watch:{src:{immediate:!0,handler:function(t){t?this.isError=!1:(this.isError=!0,this.loading=!1)}}},computed:{wrapStyle:function(){var t={};return t.width=this.$u.addUnit(this.width),t.height=this.$u.addUnit(this.height),t.borderRadius="circle"==this.shape?"50%":this.$u.addUnit(this.borderRadius),t.overflow=this.borderRadius>0?"hidden":"visible",this.fade&&(t.opacity=this.opacity,t.transition="opacity ".concat(Number(this.durationTime)/1e3,"s ease-in-out")),t}},methods:{onClick:function(){this.$emit("click")},onErrorHandler:function(t){this.loading=!1,this.isError=!0,this.$emit("error",t)},onLoadHandler:function(){var t=this;if(this.loading=!1,this.isError=!1,this.$emit("load"),!this.fade)return this.removeBgColor();this.opacity=0,this.durationTime=0,setTimeout((function(){t.durationTime=t.duration,t.opacity=1,setTimeout((function(){t.removeBgColor()}),t.durationTime)}),50)},removeBgColor:function(){this.backgroundStyle={backgroundColor:"transparent"}}}};e.default=o},"1d45":function(t,e,a){var o=a("a2eb");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("4f06").default;i("49fb0549",o,!0,{sourceMap:!1,shadowMode:!1})},2093:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return o}));var o={uIcon:a("ec4d").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"u-image",style:[t.wrapStyle,t.backgroundStyle],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onClick.apply(void 0,arguments)}}},[t.isError?t._e():a("v-uni-image",{staticClass:"u-image__image",style:{borderRadius:"circle"==t.shape?"50%":t.$u.addUnit(t.borderRadius)},attrs:{src:t.src,mode:t.mode,"lazy-load":t.lazyLoad,"show-menu-by-longpress":t.showMenuByLongpress},on:{error:function(e){arguments[0]=e=t.$handleEvent(e),t.onErrorHandler.apply(void 0,arguments)},load:function(e){arguments[0]=e=t.$handleEvent(e),t.onLoadHandler.apply(void 0,arguments)}}}),t.showLoading&&t.loading?a("v-uni-view",{staticClass:"u-image__loading",style:{borderRadius:"circle"==t.shape?"50%":t.$u.addUnit(t.borderRadius),backgroundColor:this.bgColor}},[t.$slots.loading?t._t("loading"):a("u-icon",{attrs:{name:t.loadingIcon,width:t.width,height:t.height}})],2):t._e(),t.showError&&t.isError&&!t.loading?a("v-uni-view",{staticClass:"u-image__error",style:{borderRadius:"circle"==t.shape?"50%":t.$u.addUnit(t.borderRadius)}},[t.$slots.error?t._t("error"):a("u-icon",{attrs:{name:t.errorIcon,width:t.width,height:t.height}})],2):t._e()],1)},r=[]},"256c":function(t,e,a){"use strict";a("4160"),a("a434"),a("e25e"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{loadStatus:"loadmore",flowList:[],imageUploadItem:{progress:0},operationItem:{},operationShow:!1,operationList:[{text:"删除",color:"red",fontSize:28}],show:!1,showUrl:void 0,scrollTop:0,page:0,total:20,imageSwiperList:[],imageSwipeCurrent:0,flag:0,lastX:0,lastY:0,index:0}},onLoad:function(){this.addRandomData()},onPageScroll:function(t){this.scrollTop=t.scrollTop},onReachBottom:function(){this.addRandomData()},methods:{addRandomData:function(){var t=this;this.flowList.length>=this.total?this.loadStatus="nomore":(this.loadStatus="loading",this.$u.get("/api/file/image/list?offset="+this.flowList.length).then((function(e){var a=e.total,o=e.data;t.total=a,o.forEach((function(e){e.id=t.$u.guid(),e.url=e.url,t.flowList.push(e)})),t.flowList.length>=t.total?t.loadStatus="nomore":t.loadStatus="loadmore"})).catch((function(e){t.loadStatus="loadmore"})))},reloadImage:function(){var t=this;this.$u.get("/api/file/image/sort").then((function(){t.flowList=[],t.$refs.uWaterfall.clear(),t.addRandomData()}))},imageSwipeChange:function(t){this.imageSwipeCurrent=t.target.current,t.target.current>this.flowList.length-3&&this.addRandomData()},showDetal:function(t){var e=this;this.flowList.forEach((function(a,o){if(a.id==t.id)return e.imageSwipeCurrent=o,void(e.show=!0)}))},oprate:function(t){this.operationItem=t,this.operationShow=!0},operationClick:function(t){0===t&&this.deleteSwiperItem(this.operationItem)},chooseImage:function(){var t=this;uni.chooseImage({success:function(e){console.log(e),t.uploadImage(e.tempFilePaths)}})},progressColor:function(t){var e=230-2*t,a=150+parseInt(t/2),o=10+parseInt(t);return"rgb("+e+", "+a+", "+o+")"},uploadImage:function(t){var e=this,a=t.length,o=function o(i){e.imageUploadItem.progress=0;t[i];var r=uni.uploadFile({url:e.$u.http.config.baseUrl+"/api/file/image/upload",filePath:t[i],name:"file",success:function(t){var r=JSON.parse(t.data);r.id=e.$u.guid(),e.flowList.splice(0,0,r),e.$refs.uTips.show({title:"上传成功",type:"success",duration:"2300"}),i<a-1?o(i+1):e.imageUploadItem.progress=0},fail:function(t){e.$refs.uTips.show({title:"上传失败",type:"error",duration:"2300"}),i<a-1?o(i+1):e.imageUploadItem.progress=0}});r.onProgressUpdate((function(t){e.imageUploadItem.progress=t.progress}))};o(0)},handletouchmove:function(t){},handletouchstart:function(t){this.lastX=t.changedTouches[0].pageX,this.lastY=t.changedTouches[0].pageY},handletouchend:function(t){if(0===this.flag){var e=t.changedTouches[0].pageX,a=t.changedTouches[0].pageY,o=e-this.lastX,i=a-this.lastY;this.mindex=-1,Math.abs(o)<Math.abs(i)&&i<0&&(this.flag=3,Math.abs(i)>100&&this.deleteSwiperItem(this.flowList[this.imageSwipeCurrent])),this.lastX=e,this.lastY=a,this.flag=0}},deleteSwiperItem:function(t){var e=this;this.$u.delete("/api/file/image/delete/"+t.name).then((function(a){for(var o=e.flowList.length,i=0;i<o;i++){var r=e.flowList[i];if(r.id==t.id){e.flowList.splice(i,1);break}}e.imageSwipeCurrent>e.flowList.length-3&&e.addRandomData(),e.$refs.uWaterfall.remove(t.id),e.total--}))}}};e.default=o},"66c0":function(t,e,a){"use strict";var o=a("1d45"),i=a.n(o);i.a},"6cf9":function(t,e,a){"use strict";a.r(e);var o=a("9279"),i=a("eebf");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a("a586");var n,s=a("f0c5"),l=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"232424ca",null,!1,o["a"],n);e["default"]=l.exports},7645:function(t,e,a){var o=a("ac50");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("4f06").default;i("88025100",o,!0,{sourceMap:!1,shadowMode:!1})},"76dc":function(t,e,a){"use strict";a.r(e);var o=a("13a1"),i=a.n(o);for(var r in o)"default"!==r&&function(t){a.d(e,t,(function(){return o[t]}))}(r);e["default"]=i.a},9279:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return o}));var o={uNavbar:a("938f").default,uIcon:a("ec4d").default,uCircleProgress:a("e4e1").default,uWaterfall:a("9351").default,uLazyLoad:a("7823").default,uLoadmore:a("1a90").default,uBackTop:a("5f1a").default,uTopTips:a("eea5").default,uPopup:a("a204").default,uImage:a("f403").default,uActionSheet:a("9d81").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{class:t.vuex_theme},[a("u-navbar",{staticClass:"image-detail-content-title",attrs:{title:"图片","is-back":!1,"title-bold":!0,background:{background:t.vuex_bar_color},"border-bottom":!1}},[a("v-uni-view",{staticClass:"slot-wrap",attrs:{slot:"right"},slot:"right"},[a("u-icon",{staticClass:"slot-wrap-right",attrs:{name:"reload",size:"40"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.reloadImage.apply(void 0,arguments)}}}),t.imageUploadItem.progress?a("u-circle-progress",{staticClass:"pre-box-item-progress slot-wrap-right",attrs:{width:40,"border-width":"3",percent:t.imageUploadItem.progress,"bg-color":"none",round:!0,"active-color":t.progressColor(t.imageUploadItem.progress)}}):a("u-icon",{staticClass:"slot-wrap-right",attrs:{name:"plus",size:"40"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}})],1)],1),a("u-waterfall",{ref:"uWaterfall",scopedSlots:t._u([{key:"left",fn:function(e){var o=e.leftList;return t._l(o,(function(e,o){return a("v-uni-view",{key:o,staticClass:"image-warter-left color-gradual",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.showDetal(e)},longpress:function(a){arguments[0]=a=t.$handleEvent(a),t.oprate(e)}}},[a("u-lazy-load",{staticClass:"color-gradual-same",attrs:{threshold:-10,"border-radius":"10",image:t.$u.http.config.baseUrl+encodeURI(e.url)+"?x-oss-process=image/resize,w_400,q_6,limit_0"}})],1)}))}},{key:"right",fn:function(e){var o=e.rightList;return t._l(o,(function(e,o){return a("v-uni-view",{key:o,staticClass:"image-warter-right color-gradual",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.showDetal(e)},longpress:function(a){arguments[0]=a=t.$handleEvent(a),t.oprate(e)}}},[a("u-lazy-load",{staticClass:"color-gradual-same",attrs:{threshold:-10,"border-radius":"10",image:t.$u.http.config.baseUrl+encodeURI(e.url)+"?x-oss-process=image/resize,w_400,q_6,limit_0"}})],1)}))}}]),model:{value:t.flowList,callback:function(e){t.flowList=e},expression:"flowList"}}),a("u-loadmore",{attrs:{status:t.loadStatus},on:{loadmore:function(e){arguments[0]=e=t.$handleEvent(e),t.addRandomData.apply(void 0,arguments)}}}),a("u-back-top",{staticClass:"color-gradual",attrs:{"scroll-top":t.scrollTop,top:"1"}}),a("u-top-tips",{ref:"uTips"}),a("u-popup",{staticClass:"color-gradual-same",attrs:{"border-radius":"10",mode:"bottom",height:"100%",mask:!0,closeable:!0,"close-icon-pos":"bottom-left","close-icon-size":44},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-uni-swiper",{staticClass:"image-swiper color-gradual-same",attrs:{autoplay:!1,current:t.imageSwipeCurrent,circular:!1,"img-mode":"aspectFit"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.imageSwipeChange.apply(void 0,arguments)}}},t._l(t.flowList,(function(e,o){return a("v-uni-swiper-item",{staticClass:"color-gradual-same",on:{touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.handletouchmove.apply(void 0,arguments)},touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.handletouchstart.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.handletouchend.apply(void 0,arguments)}}},[o<t.imageSwipeCurrent+2&&o>t.imageSwipeCurrent-2?a("u-image",{staticClass:"image-swiper-image color-gradual-same",attrs:{src:t.$u.http.config.baseUrl+e.url,mode:"aspectFit",draggable:!1,"lazy-load":!0}}):t._e()],1)})),1)],1),a("u-action-sheet",{staticClass:"operation",attrs:{list:t.operationList,"cancel-btn":!1},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.operationClick.apply(void 0,arguments)}},model:{value:t.operationShow,callback:function(e){t.operationShow=e},expression:"operationShow"}})],1)},r=[]},a2eb:function(t,e,a){var o=a("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 下方引入的为uView UI的集成样式文件，为scss预处理器，其中包含了一些"u-"开头的自定义变量\r\n * 使用的时候，请将下面的一行复制到您的uniapp项目根目录的uni.scss中即可\r\n * uView自定义的css类名和scss变量，均以"u-"开头，不会造成冲突，请放心使用 \r\n */.u-image[data-v-00140dbc]{position:relative;transition:opacity .5s ease-in-out}.u-image__image[data-v-00140dbc]{width:100%;height:100%}.u-image__loading[data-v-00140dbc], .u-image__error[data-v-00140dbc]{position:absolute;top:0;left:0;width:100%;height:100%;\r\ndisplay:flex;flex-direction:row;\r\nalign-items:center;justify-content:center;background-color:#f3f4f6;color:#909399;font-size:%?46?%}',""]),t.exports=e},a586:function(t,e,a){"use strict";var o=a("7645"),i=a.n(o);i.a},ac50:function(t,e,a){var o=a("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 下方引入的为uView UI的集成样式文件，为scss预处理器，其中包含了一些"u-"开头的自定义变量\r\n * 使用的时候，请将下面的一行复制到您的uniapp项目根目录的uni.scss中即可\r\n * uView自定义的css类名和scss变量，均以"u-"开头，不会造成冲突，请放心使用 \r\n */.image-warter-left[data-v-232424ca]{border-radius:8px;padding:%?8?% %?8?% %?8?% %?16?%;position:relative}.slot-wrap-right[data-v-232424ca]{margin:%?2?% %?20?%}.image-warter-right[data-v-232424ca]{border-radius:8px;padding:%?8?% %?16?% %?8?% %?8?%;position:relative}.u-close[data-v-232424ca]{position:absolute;top:%?32?%;right:%?32?%}.image-swiper[data-v-232424ca]{height:100%}.image-swiper-image[data-v-232424ca]{width:100%;height:100%!important}.dark .image-swiper-image[data-v-232424ca]{background-color:#111!important}.light .image-swiper-image[data-v-232424ca]{background-color:#eee!important}.image-image[data-v-232424ca]{width:100%;border-radius:4px}.image-title[data-v-232424ca]{font-size:%?15?%;margin-top:5px;color:#909399;word-break:break-all}.image-shop[data-v-232424ca]{font-size:8px;color:#303133;margin-top:5px}.image-dialog[data-v-232424ca]{width:100%;height:100%}.upload-btn[data-v-232424ca]{position:absolute;right:0;bottom:0}',""]),t.exports=e},eebf:function(t,e,a){"use strict";a.r(e);var o=a("256c"),i=a.n(o);for(var r in o)"default"!==r&&function(t){a.d(e,t,(function(){return o[t]}))}(r);e["default"]=i.a},f403:function(t,e,a){"use strict";a.r(e);var o=a("2093"),i=a("76dc");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a("66c0");var n,s=a("f0c5"),l=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"00140dbc",null,!1,o["a"],n);e["default"]=l.exports}}]);